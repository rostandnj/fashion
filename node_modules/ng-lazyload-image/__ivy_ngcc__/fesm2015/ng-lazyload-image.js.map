{"version":3,"file":"ng-lazyload-image.js","sources":["ng-lazyload-image/src/util/css.util.ts","ng-lazyload-image/src/util/util.ts","ng-lazyload-image/src/shared-preset/preset.ts","ng-lazyload-image/src/intersection-observer-preset/intersection-listener.ts","ng-lazyload-image/src/intersection-observer-preset/preset.ts","ng-lazyload-image/src/ssr-preset/preset.ts","ng-lazyload-image/src/hooks-factory.ts","ng-lazyload-image/src/lazyload-image.ts","ng-lazyload-image/src/lazyload-image.directive.ts","ng-lazyload-image/src/lazyload-image.module.ts","ng-lazyload-image/src/scroll-preset/rect.ts","ng-lazyload-image/src/scroll-preset/scroll-listener.ts","ng-lazyload-image/src/scroll-preset/preset.ts","ng-lazyload-image/index.ts","ng-lazyload-image/ng-lazyload-image.ts"],"names":["isVisible","getObservable","loadImage"],"mappings":"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","sourcesContent":["export const cssClassNames = {\n  loaded: 'ng-lazyloaded',\n  loading: 'ng-lazyloading',\n  failed: 'ng-failed-lazyloaded'\n};\n\nexport function removeCssClassName(element: HTMLImageElement | HTMLDivElement, cssClassName: string) {\n  element.className = element.className.replace(cssClassName, '');\n}\n\nexport function addCssClassName(element: HTMLImageElement | HTMLDivElement, cssClassName: string) {\n  if (!element.className.includes(cssClassName)) {\n    element.className += ` ${cssClassName}`;\n  }\n}\n\nexport function hasCssClassName(element: HTMLImageElement | HTMLDivElement, cssClassName: string) {\n  return element.className && element.className.includes(cssClassName);\n}\n","export function getNavigator(): Navigator | undefined {\n  return typeof window !== 'undefined' ? window.navigator : undefined;\n}\n\nexport function isChildOfPicture(element: HTMLImageElement | HTMLDivElement): boolean {\n  return Boolean(element.parentElement && element.parentElement.nodeName.toLowerCase() === 'picture');\n}\n\nexport function isImageElement(element: HTMLImageElement | HTMLDivElement): element is HTMLImageElement {\n  return element.nodeName.toLowerCase() === 'img';\n}\n\nexport function setImage(element: HTMLImageElement | HTMLDivElement, imagePath: string, useSrcset?: boolean) {\n  if (isImageElement(element)) {\n    if (useSrcset && 'srcset' in element) {\n      element.srcset = imagePath;\n    } else {\n      element.src = imagePath;\n    }\n  } else {\n    element.style.backgroundImage = `url('${imagePath}')`;\n  }\n  return element;\n}\n\nfunction setSources(attrName: string) {\n  return (image: HTMLImageElement) => {\n    const sources = image.parentElement!.getElementsByTagName('source');\n    for (let i = 0; i < sources.length; i++) {\n      const attrValue = sources[i].getAttribute(attrName);\n      if (attrValue) {\n        // Check if `srcset` is supported by the current browser\n        if ('srcset' in sources[i]) {\n          sources[i].srcset = attrValue;\n        } else {\n          sources[i].src = attrValue;\n        }\n      }\n    }\n  };\n}\n\nconst setSourcesToDefault = setSources('defaultImage');\nexport const setSourcesToLazy = setSources('lazyLoad');\nconst setSourcesToError = setSources('errorImage');\n\nfunction setImageAndSources(setSourcesFn: (image: HTMLImageElement) => void) {\n  return (element: HTMLImageElement | HTMLDivElement, imagePath?: string, useSrcset?: boolean) => {\n    if (isImageElement(element) && isChildOfPicture(element)) {\n      setSourcesFn(element);\n    }\n    if (imagePath) {\n      setImage(element, imagePath, useSrcset);\n    }\n  };\n}\n\nexport const setImageAndSourcesToDefault = setImageAndSources(setSourcesToDefault);\nexport const setImageAndSourcesToLazy = setImageAndSources(setSourcesToLazy);\nexport const setImageAndSourcesToError = setImageAndSources(setSourcesToError);\n","import { FinallyFn, IsBotFn, LoadImageFn, SetErrorImageFn, SetLoadedImageFn, SetupFn } from '../types';\nimport {\n  addCssClassName,\n  cssClassNames,\n  hasCssClassName,\n  isChildOfPicture,\n  isImageElement,\n  removeCssClassName,\n  setImage,\n  setImageAndSourcesToDefault,\n  setImageAndSourcesToError,\n  setImageAndSourcesToLazy,\n  setSourcesToLazy\n} from '../util';\n\nconst end: FinallyFn = ({ element }) => {\n  addCssClassName(element, cssClassNames.loaded);\n  removeCssClassName(element, cssClassNames.loading);\n};\n\nexport const loadImage: LoadImageFn = ({ element, useSrcset, imagePath, decode }) => {\n  let img: HTMLImageElement;\n  if (isImageElement(element) && isChildOfPicture(element)) {\n    const parentClone = element.parentNode!.cloneNode(true) as HTMLPictureElement;\n    img = parentClone.getElementsByTagName('img')[0];\n    setSourcesToLazy(img);\n    setImage(img, imagePath, useSrcset);\n  } else {\n    img = new Image();\n    if (isImageElement(element) && element.sizes) {\n      img.sizes = element.sizes;\n    }\n    if (useSrcset && 'srcset' in img) {\n      img.srcset = imagePath;\n    } else {\n      img.src = imagePath;\n    }\n  }\n\n  if (decode && img.decode) {\n    return img.decode().then(() => imagePath);\n  }\n\n  return new Promise((resolve, reject) => {\n    img.onload = () => resolve(imagePath);\n    img.onerror = () => reject(null);\n  });\n};\n\nconst setErrorImage: SetErrorImageFn = ({ element, errorImagePath, useSrcset }) => {\n  setImageAndSourcesToError(element, errorImagePath, useSrcset);\n  addCssClassName(element, cssClassNames.failed);\n};\n\nconst setLoadedImage: SetLoadedImageFn = ({ element, imagePath, useSrcset }) => {\n  setImageAndSourcesToLazy(element, imagePath, useSrcset);\n};\n\nconst setup: SetupFn = ({ element, defaultImagePath, useSrcset }) => {\n  setImageAndSourcesToDefault(element, defaultImagePath, useSrcset);\n  addCssClassName(element, cssClassNames.loading);\n\n  if (hasCssClassName(element, cssClassNames.loaded)) {\n    removeCssClassName(element, cssClassNames.loaded);\n  }\n};\n\nexport const isBot: IsBotFn = navigator => {\n  if (navigator && navigator.userAgent) {\n    return /googlebot|bingbot|yandex|baiduspider|facebookexternalhit|twitterbot|rogerbot|linkedinbot|embedly|quora\\ link\\ preview|showyoubot|outbrain|pinterest\\/0\\.|pinterestbot|slackbot|vkShare|W3C_Validator|whatsapp|duckduckbot/i.test(\n      navigator.userAgent\n    );\n  }\n  return false;\n};\n\nexport const sharedPreset = {\n  finally: end,\n  loadImage,\n  setErrorImage,\n  setLoadedImage,\n  setup,\n  isBot\n};\n","import { Observable, Subject } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Attributes } from '../types';\n\ntype ObserverOptions = {\n  root: Element | null;\n  rootMargin?: string;\n};\n\nconst observers = new WeakMap<Element | {}, IntersectionObserver>();\n\nconst intersectionSubject = new Subject<IntersectionObserverEntry>();\n\nfunction loadingCallback(entrys: IntersectionObserverEntry[]) {\n  entrys.forEach(entry => intersectionSubject.next(entry));\n}\n\nconst uniqKey = {};\n\nexport const getIntersectionObserver = (attributes: Attributes): Observable<IntersectionObserverEntry> => {\n  const scrollContainerKey = attributes.scrollContainer || uniqKey;\n  const options: ObserverOptions = {\n    root: attributes.scrollContainer || null\n  };\n  if (attributes.offset) {\n    options.rootMargin = `${attributes.offset}px`;\n  }\n\n  let observer = observers.get(scrollContainerKey);\n\n  if (!observer) {\n    observer = new IntersectionObserver(loadingCallback, options);\n    observers.set(scrollContainerKey, observer);\n  }\n\n  observer.observe(attributes.element);\n\n  return Observable.create((obs: Subject<IntersectionObserverEntry>) => {\n    const subscription = intersectionSubject.pipe(filter(entry => entry.target === attributes.element)).subscribe(obs);\n    return () => {\n      subscription.unsubscribe();\n      observer!.unobserve(attributes.element);\n    };\n  });\n};\n","import { sharedPreset } from '../shared-preset/preset';\nimport { Attributes, GetObservableFn, HookSet, IsVisibleFn } from '../types';\nimport { getIntersectionObserver } from './intersection-listener';\n\nexport const isVisible: IsVisibleFn<IntersectionObserverEntry> = ({ event }) => {\n  return event.isIntersecting;\n};\n\nexport const getObservable: GetObservableFn<IntersectionObserverEntry> = (attributes: Attributes, _getInterObserver = getIntersectionObserver) => {\n  if (attributes.customObservable) {\n    return attributes.customObservable;\n  }\n  return _getInterObserver(attributes);\n};\n\nexport const intersectionObserverPreset: HookSet<IntersectionObserverEntry> = Object.assign({}, sharedPreset, {\n  isVisible,\n  getObservable\n});\n","import { of } from 'rxjs';\nimport { GetObservableFn, HookSet, IsVisibleFn, LoadImageFn } from '../types';\nimport { sharedPreset } from '../shared-preset/preset';\n\nconst isVisible: IsVisibleFn<string> = () => {\n  return true;\n};\n\nconst getObservable: GetObservableFn<string> = () => {\n  return of('load');\n};\n\nconst loadImage: LoadImageFn = ({ imagePath }) => {\n  return [imagePath];\n};\n\nexport const ssrPreset: HookSet<string> = Object.assign({}, sharedPreset, {\n  isVisible,\n  getObservable,\n  loadImage\n});\n","import { intersectionObserverPreset } from './intersection-observer-preset';\nimport { ssrPreset } from './ssr-preset';\nimport { HookSet, ModuleOptions } from './types';\nimport { getNavigator } from './util';\n\nexport function createHooks<E>(platformId: Object, options?: ModuleOptions<E>): HookSet<any> {\n  const defaultPreset = intersectionObserverPreset;\n  const isBot = options && options.isBot ? options.isBot : defaultPreset.isBot;\n\n  if (isBot(getNavigator(), platformId)) {\n    return Object.assign(ssrPreset, { isBot });\n  } else if (!options) {\n    return defaultPreset;\n  }\n\n  const hooks = {};\n  if (options.preset) {\n    Object.assign(hooks, options.preset);\n  } else {\n    Object.assign(hooks, defaultPreset);\n  }\n  Object.keys(options)\n    .filter(key => key !== 'preset')\n    .forEach(key => {\n      hooks[key] = options[key];\n    });\n  return hooks as HookSet<any>;\n}\n","import { Observable, of } from 'rxjs';\nimport { catchError, filter, map, mergeMap, take, tap } from 'rxjs/operators';\nimport { Attributes, HookSet } from './types';\n\nexport function lazyLoadImage<E>(hookSet: HookSet<E>, attributes: Attributes) {\n  return (evntObservable: Observable<E>): Observable<boolean> => {\n    return evntObservable.pipe(\n      tap(data => attributes.onStateChange.emit({ reason: 'observer-emit', data })),\n      filter(event =>\n        hookSet.isVisible({\n          element: attributes.element,\n          event: event,\n          offset: attributes.offset,\n          scrollContainer: attributes.scrollContainer\n        })\n      ),\n      take(1),\n      tap(() => attributes.onStateChange.emit({ reason: 'start-loading' })),\n      mergeMap(() => hookSet.loadImage(attributes)),\n      tap(() => attributes.onStateChange.emit({ reason: 'mount-image' })),\n      tap(imagePath =>\n        hookSet.setLoadedImage({\n          element: attributes.element,\n          imagePath,\n          useSrcset: attributes.useSrcset\n        })\n      ),\n      tap(() => attributes.onStateChange.emit({ reason: 'loading-succeeded' })),\n      map(() => true),\n      catchError(error => {\n        attributes.onStateChange.emit({ reason: 'loading-failed', data: error });\n        hookSet.setErrorImage(attributes);\n        return of(false);\n      }),\n      tap(() => {\n        attributes.onStateChange.emit({ reason: 'finally' });\n        hookSet.finally(attributes);\n      })\n    ) as Observable<boolean>;\n  };\n}\n","import { isPlatformServer } from '@angular/common';\nimport { AfterContentInit, Directive, ElementRef, EventEmitter, Inject, Input, NgZone, OnChanges, OnDestroy, Optional, Output, PLATFORM_ID } from '@angular/core';\nimport { Observable, ReplaySubject, Subscription, never } from 'rxjs';\nimport { switchMap, tap } from 'rxjs/operators';\nimport { createHooks } from './hooks-factory';\nimport { lazyLoadImage } from './lazyload-image';\nimport { Attributes, HookSet, ModuleOptions, StateChange } from './types';\nimport { getNavigator } from './util';\n\n@Directive({\n  selector: '[lazyLoad]'\n})\nexport class LazyLoadImageDirective implements OnChanges, AfterContentInit, OnDestroy {\n  @Input('lazyLoad') lazyImage!: string; // The image to be lazy loaded\n  @Input() defaultImage?: string; // The image to be displayed before lazyImage is loaded\n  @Input() errorImage?: string; // The image to be displayed if lazyImage load fails\n  @Input() scrollTarget?: any; // Scroll container that contains the image and emits scoll events\n  @Input() customObservable?: Observable<any>; // Pass your own event emitter\n  @Input() offset?: number; // The number of px a image should be loaded before it is in view port\n  @Input() useSrcset?: boolean; // Whether srcset attribute should be used instead of src\n  @Input() decode?: boolean; // Decode the image before appending to the DOM\n  @Input() debug?: boolean; // Will print some debug info when `true`\n  @Output() onStateChange: EventEmitter<StateChange> = new EventEmitter(); // Emits an event on every state change\n  @Output() onLoad: EventEmitter<boolean> = new EventEmitter(); // @deprecated use `onStateChange` instead.\n  private propertyChanges$: ReplaySubject<Attributes>;\n  private elementRef: ElementRef;\n  private ngZone: NgZone;\n  private loadSubscription?: Subscription;\n  private debugSubscription?: Subscription;\n  private hooks: HookSet<any>;\n  private platformId: Object;\n\n  constructor(el: ElementRef, ngZone: NgZone, @Inject(PLATFORM_ID) platformId: Object, @Optional() @Inject('options') options?: ModuleOptions) {\n    this.elementRef = el;\n    this.ngZone = ngZone;\n    this.propertyChanges$ = new ReplaySubject();\n    this.platformId = platformId;\n    this.hooks = createHooks(platformId, options);\n  }\n\n  ngOnChanges() {\n    if (this.debug === true && !this.debugSubscription) {\n      this.debugSubscription = this.onStateChange.subscribe((e: StateChange) => console.log(e));\n    }\n\n    this.propertyChanges$.next({\n      element: this.elementRef.nativeElement,\n      imagePath: this.lazyImage,\n      defaultImagePath: this.defaultImage,\n      errorImagePath: this.errorImage,\n      useSrcset: this.useSrcset,\n      offset: this.offset ? this.offset | 0 : 0,\n      scrollContainer: this.scrollTarget,\n      customObservable: this.customObservable,\n      decode: this.decode,\n      onStateChange: this.onStateChange\n    });\n  }\n\n  ngAfterContentInit() {\n    // Don't do anything if SSR and the user isn't a bot\n    if (isPlatformServer(this.platformId) && !this.hooks.isBot(getNavigator(), this.platformId)) {\n      return null;\n    }\n\n    this.ngZone.runOutsideAngular(() => {\n      this.loadSubscription = this.propertyChanges$\n        .pipe(\n          tap(attributes => attributes.onStateChange.emit({ reason: 'setup' })),\n          tap(attributes => this.hooks.setup(attributes)),\n          switchMap(attributes => {\n            if (!attributes.imagePath) {\n              return never();\n            }\n            return this.hooks.getObservable(attributes).pipe(lazyLoadImage(this.hooks, attributes));\n          })\n        )\n        .subscribe(success => this.onLoad.emit(success));\n    });\n  }\n\n  ngOnDestroy() {\n    this.loadSubscription?.unsubscribe();\n    this.debugSubscription?.unsubscribe();\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { LazyLoadImageDirective } from './lazyload-image.directive';\nimport { ModuleOptions } from './types';\n\n@NgModule({\n  declarations: [LazyLoadImageDirective],\n  exports: [LazyLoadImageDirective]\n})\nexport class LazyLoadImageModule {\n  static forRoot(options: ModuleOptions): ModuleWithProviders {\n    return {\n      ngModule: LazyLoadImageModule,\n      providers: [{ provide: 'options', useValue: options }]\n    };\n  }\n}\n","export class Rect {\n  static empty: Rect = new Rect(0, 0, 0, 0);\n\n  left: number;\n  top: number;\n  right: number;\n  bottom: number;\n\n  constructor(left: number, top: number, right: number, bottom: number) {\n    this.left = left;\n    this.top = top;\n    this.right = right;\n    this.bottom = bottom;\n  }\n\n  static fromElement(element: HTMLElement): Rect {\n    const { left, top, right, bottom } = element.getBoundingClientRect();\n\n    if (left === 0 && top === 0 && right === 0 && bottom === 0) {\n      return Rect.empty;\n    } else {\n      return new Rect(left, top, right, bottom);\n    }\n  }\n\n  static fromWindow(_window: Window): Rect {\n    return new Rect(0, 0, _window.innerWidth, _window.innerHeight);\n  }\n\n  inflate(inflateBy: number) {\n    this.left -= inflateBy;\n    this.top -= inflateBy;\n    this.right += inflateBy;\n    this.bottom += inflateBy;\n  }\n\n  intersectsWith(rect: Rect): boolean {\n    return rect.left < this.right && this.left < rect.right && rect.top < this.bottom && this.top < rect.bottom;\n  }\n\n  getIntersectionWith(rect: Rect): Rect {\n    const left = Math.max(this.left, rect.left);\n    const top = Math.max(this.top, rect.top);\n    const right = Math.min(this.right, rect.right);\n    const bottom = Math.min(this.bottom, rect.bottom);\n\n    if (right >= left && bottom >= top) {\n      return new Rect(left, top, right, bottom);\n    } else {\n      return Rect.empty;\n    }\n  }\n}\n","import { empty, Observable, Subject } from 'rxjs';\nimport { sampleTime, share, startWith } from 'rxjs/operators';\n\nconst scrollListeners = new WeakMap<any, Observable<any>>();\n\nexport function sampleObservable<T>(obs: Observable<T>, scheduler?: any): Observable<T | ''> {\n  return obs.pipe(sampleTime(100, scheduler), share(), startWith(''));\n}\n\n// Only create one scroll listener per target and share the observable.\n// Typical, there will only be one observable per application\nexport const getScrollListener = (scrollTarget?: HTMLElement | Window): Observable<Event | ''> => {\n  if (!scrollTarget || typeof scrollTarget.addEventListener !== 'function') {\n    console.warn('`addEventListener` on ' + scrollTarget + ' (scrollTarget) is not a function. Skipping this target');\n    return empty();\n  }\n  const scrollListener = scrollListeners.get(scrollTarget);\n  if (scrollListener) {\n    return scrollListener;\n  }\n\n  const srollEvent: Observable<Event> = Observable.create((observer: Subject<Event>) => {\n    const eventName = 'scroll';\n    const handler = (event: Event) => observer.next(event);\n    const options = { passive: true, capture: false };\n    scrollTarget.addEventListener(eventName, handler, options);\n    return () => scrollTarget.removeEventListener(eventName, handler, options);\n  });\n\n  const listener = sampleObservable(srollEvent);\n  scrollListeners.set(scrollTarget, listener);\n  return listener;\n};\n","import { startWith } from 'rxjs/operators';\nimport { sharedPreset } from '../shared-preset/preset';\nimport { Attributes, GetObservableFn, HookSet, IsVisibleFn } from '../types';\nimport { Rect } from './rect';\nimport { getScrollListener } from './scroll-listener';\n\nexport const isVisible: IsVisibleFn<Event | string> = ({ element, offset, scrollContainer }, getWindow = () => window) => {\n  const elementBounds = Rect.fromElement(element);\n  if (elementBounds === Rect.empty) {\n    return false;\n  }\n  const windowBounds = Rect.fromWindow(getWindow());\n  elementBounds.inflate(offset);\n\n  if (scrollContainer) {\n    const scrollContainerBounds = Rect.fromElement(scrollContainer);\n    const intersection = scrollContainerBounds.getIntersectionWith(windowBounds);\n    return elementBounds.intersectsWith(intersection);\n  } else {\n    return elementBounds.intersectsWith(windowBounds);\n  }\n};\n\nconst getObservable: GetObservableFn<Event | string> = (attributes: Attributes) => {\n  if (attributes.customObservable) {\n    return attributes.customObservable.pipe(startWith(''));\n  }\n  if (attributes.scrollContainer) {\n    return getScrollListener(attributes.scrollContainer);\n  }\n  return getScrollListener(window);\n};\n\nexport const scrollPreset: HookSet<Event | string> = Object.assign({}, sharedPreset, {\n  isVisible,\n  getObservable\n});\n","import { LazyLoadImageDirective } from './src/lazyload-image.directive';\nimport { LazyLoadImageModule } from './src/lazyload-image.module';\nimport { intersectionObserverPreset } from './src/intersection-observer-preset';\nimport { scrollPreset } from './src/scroll-preset';\nimport { ModuleOptions, HookSet, IsVisibleProps, SetLoadedImageProps, SetErrorImageProps, LoadImageProps, Attributes, IsVisibleFn, LoadImageFn, SetLoadedImageFn, SetErrorImageFn, SetupFn, FinallyFn, GetObservableFn, StateChange } from './src/types';\n\nexport { LazyLoadImageDirective, LazyLoadImageModule, intersectionObserverPreset, scrollPreset, ModuleOptions, HookSet, IsVisibleProps, SetLoadedImageProps, SetErrorImageProps, LoadImageProps, Attributes, IsVisibleFn, LoadImageFn, SetLoadedImageFn, SetErrorImageFn, SetupFn, FinallyFn, GetObservableFn, StateChange };\nexport default LazyLoadImageModule;\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}