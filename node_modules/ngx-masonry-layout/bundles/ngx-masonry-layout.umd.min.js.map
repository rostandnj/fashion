{"version":3,"sources":["ng://ngx-masonry-layout/lib/masonry-layout.component.ts","ng://ngx-masonry-layout/lib/masonry-layout.module.ts"],"names":["MasonryLayoutComponent","elementRef","this","EventEmitter","elem","nativeElement","Object","defineProperty","prototype","value","GUTTER","a","check","navigator","userAgent","vendor","test","substr","onWindowResize","event","_this","clearTimeout","resizeTimer","setTimeout","gridState","buildGrid","ngOnInit","ngOnChanges","changesTimer","parentWidth","Math","floor","parentNode","offsetWidth","row","startIndex","endIndex","length","totalWidth","images","style","width","display","forEach","node","index","getComputedWidth","isLastChild","scaling","setColDimensions","totalRowWidth","ENABLE_MASONRY","computedHeight","MAX_HEIGHT","computedWidth","margin","getNodeMargin","nodeWidth","isMobile","height","clickOnImage","image","i","events","emit","type","onImageLoaded","opacity","Component","args","selector","template","ElementRef","Input","Output","HostListener","MasonryLayoutModule","NgModule","declarations","imports","CommonModule","exports","entryComponents"],"mappings":"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","sourcesContent":["import { Component, ElementRef, HostListener, Input, Output, OnInit, OnChanges, EventEmitter } from '@angular/core';\n\nexport interface Image {\n    path: string; \n    width: number; \n    height: number;\n    computedHeight?: string;\n    computedWidth?: string;\n    margin?: string;\n};\n\nexport interface Images extends Array<Image>{}\n\n@Component({\n    selector: 'masonry-layout', \n    template: `<div \n\t[ngClass]=\"CLASS_NAME\"\n\t*ngFor=\"let image of images; let i = index;\"\n    [style.width]=\"image.computedWidth\"\n    [style.height]=\"image.computedHeight\"\n    [style.float]=\"'left'\"\n    [style.margin]=\"image.margin\"\n    [style.background]=\"'#eeeeee'\"\n    [style.lineHeight]=\"0\">\n\t<img \n        #imageElem\n        [src]=\"image.path\" \n        [style.width.%]=\"100\" \n        [style.height]=\"'auto'\"\n        [style.opacity]=\"0\"\n        (click)=\"clickOnImage(image, i)\"\n        (load)=\"onImageLoaded(imageElem)\" />\n</div>`,\n})\n\nexport class MasonryLayoutComponent {\n    GUTTER: number = 0;\n    nodes: any;\n    elem: any;\n    savedNodeDimensions: any = [];\n    observer: any;\n    gridState: string = 'not started';\n    resizeTimer: any;\n    changesTimer: any;\n\n    @Input('images') images: Images; \n    @Input('masonry') ENABLE_MASONRY: boolean = true; \n    @Input('max-height') MAX_HEIGHT: number = 400; \n    @Input('class-name') CLASS_NAME: string | { [key: string]: any; };\n\n    @Input('gutter')\n    set gutter(value: number){\n        this.GUTTER = value / 2;\n    }\n\n    @Output() events: EventEmitter<any> = new EventEmitter<any>();\n     \n    get isMobile():boolean {\n        var check = false;\n        (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor);\n        return check;\n    };\n     \n    constructor(private elementRef: ElementRef){\n        this.elem = this.elementRef.nativeElement;\n    }\n\n    @HostListener('window:resize', ['$event'])\n    onWindowResize(event) {\n        clearTimeout(this.resizeTimer);\n\n        this.resizeTimer = setTimeout(() => {\n            this.gridState = 'not started';\n            this.buildGrid(); \n        }, 250);\n    }\n\n    ngOnInit() {\n        this.buildGrid();\n    }\n\n    ngOnChanges(){\n        clearTimeout(this.changesTimer);\n\n        this.changesTimer = setTimeout(() => {\n            this.gridState = 'not started';\n            this.buildGrid(); \n        }, 250);\n    }\n\n    buildGrid(){\n        let parentWidth = Math.floor(this.elem.parentNode.offsetWidth);\n        let totalRowWidth: any = 0; \n        let row: any = {\n            startIndex: 0,\n            endIndex: 0,\n            length: 0,\n            totalWidth: 0\n        };\n\n        if (!this.images || !this.images.length){\n            return;\n        }\n\n        this.elem.style.width = parentWidth +'px';\n        this.elem.style.display = 'table';\n\n        this.images.forEach((node, index) => {\n            if (row.totalWidth === 0){\n                row.startIndex = index;\n                row.length = 0;\n            }\n\n            row.length++;\n            row.totalWidth += this.getComputedWidth(index);\n            \n            if (row.totalWidth >= parentWidth || this.isLastChild(index)){\n                row.endIndex = index;\n                let scaling = row.totalWidth/parentWidth;\n\n                this.setColDimensions(scaling, row);\n                row.totalWidth = 0; \n            }\n        });\n    }\n\n    setColDimensions(scaling: number, row: any){\n        let totalRowWidth: any = 0;\n        let parentWidth = this.elem.parentNode.offsetWidth;\n        scaling = (scaling < 1) ? 1 : scaling;\n\n        this.images.forEach((node, index) => {\n            if (!this.ENABLE_MASONRY){\n                node.computedHeight = this.MAX_HEIGHT + 'px';\n                node.computedWidth = this.getComputedWidth(index) + 'px';\n                node.margin = this.getNodeMargin(parentWidth);\n                return;\n            }\n\n            if (index >= row.startIndex && index <= row.endIndex){\n                let nodeWidth;\n\n                // last image\n                if (index === row.endIndex && scaling > 1){ \n                    nodeWidth = (100 - totalRowWidth) - ((this.GUTTER * 2) / parentWidth * 100);\n                    node.computedWidth = 'calc('+nodeWidth+'%)';\n\n                    if (this.gridState === 'not started'){\n                        this.gridState = 'pre-building';\n\n                        setTimeout(() => {\n                            this.buildGrid();\n                        }, 100);\n                    }\n                } \n                else {\n                    nodeWidth = ((this.getComputedWidth(index) / scaling) / parentWidth * 100) - ((row.length * (this.GUTTER * 2)) * (this.getComputedWidth(index) / scaling) / parentWidth) / parentWidth * 100;\n                    node.computedWidth = 'calc('+nodeWidth+'%)';\n                    \n                    totalRowWidth += nodeWidth;\n                    totalRowWidth += (this.GUTTER / parentWidth * 100) * 2;  \n                }\n\n                // last row and last image\n                if (index === row.endIndex && row.length === 1 && this.isMobile){\n                \tnodeWidth = 100 - ((this.GUTTER * 2) / parentWidth * 100);\n                    let height = node.height * ( parentWidth * (nodeWidth / 100) / node.width);\n\n                    if (height/2 < this.MAX_HEIGHT){\n                        node.computedWidth = 'calc('+nodeWidth+'%)';\n                    }\n                }\n\n                node.margin = this.getNodeMargin(parentWidth);\n                node.computedHeight = node.height * ( parentWidth * (nodeWidth / 100) / node.width) + 'px';\n            }\n        });\n    }\n\n    getComputedWidth(index: number){\n        return this.images[index].width / (this.images[index].height / this.MAX_HEIGHT);\n    }\n\n    isLastChild(index: number){\n        return index + 1 === this.images.length;\n    }\n\n    getNodeMargin(parentWidth: number){\n        return 'calc('+this.GUTTER / parentWidth * 100+'%)';\n    }\n\n    clickOnImage(image: any, i: number){\n        this.events.emit({\n            type: 'click-on-image',\n            image: image,\n            index: i\n        });\n    }\n\n    onImageLoaded(elem){\n        elem.style.opacity = 1;\n    }\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MasonryLayoutComponent } from './masonry-layout.component'; \n\n@NgModule({\n    declarations: [\n        MasonryLayoutComponent\n    ],\n    imports: [\n        CommonModule\n    ],\n    exports: [\n        MasonryLayoutComponent\n    ],\n    entryComponents: [\n        MasonryLayoutComponent\n    ]\n})\nexport class MasonryLayoutModule { }\n"]}